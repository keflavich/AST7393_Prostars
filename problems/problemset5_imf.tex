\documentclass{article}
\usepackage[inner=2.5cm,outer=2.5cm,top=4.5cm,bottom=4.5cm]{geometry}
\pdfoutput=1
\usepackage{natbib}
\usepackage{xspace}

\usepackage{microtype} % Improves character and word spacing

\usepackage{lipsum} % Inserts dummy text

\usepackage{booktabs} % Better horizontal rules in tables
\usepackage{epsdice}

\usepackage{graphicx} % Needed to insert images into the document
\graphicspath{{graphics/}} % Sets the default location of pictures
\setkeys{Gin}{width=\linewidth,totalheight=\textheight,keepaspectratio} % Improves figure scaling

\usepackage{fancyvrb} % Allows customization of verbatim environments
\fvset{fontsize=\normalsize} % The font size of all verbatim text can be changed here

\newcommand{\hangp}[1]{\makebox[0pt][r]{(}#1\makebox[0pt][l]{)}} % New command to create parentheses around text in tables which take up no horizontal space - this improves column spacing
\newcommand{\hangstar}{\makebox[0pt][l]{*}} % New command to create asterisks in tables which take up no horizontal space - this improves column spacing

\usepackage{xspace} % Used for printing a trailing space better than using a tilde (~) using the \xspace command
\newcommand{\veco}{\ensuremath{\mathbf{\Omega}}\xspace}
\newcommand{\vecv}{\mathbf{v}\xspace}
\newcommand{\msun}{\ensuremath{\mathrm{M}_\odot}\xspace}
\newcommand{\lsun}{\ensuremath{\mathrm{L}_\odot}\xspace}
\newcommand{\ehat}{\hat{\mathbf{e}}\xspace}
\usepackage{amsmath}
\usepackage{mathtools}


\begin{document}

\noindent\textbf{Problem Set 5: IMF}

\begin{enumerate}
    \item The IMF is the function describing how many stars are born at each mass.
        \begin{equation}
            \xi \equiv \frac{dN}{dM}
        \end{equation}
        There are several common parametrizations.  We adopt $M_{max} = 120$ \msun
        as the default for all.
        \begin{enumerate}
            \item Salpeter (you will find different $M_{min}$ in use in
                different locations in the literature; we adopt 0.03 here
                to simplify comparisons):
            \begin{equation}
                \xi = M^{-2.35}, M_{min}=0.03 \msun
            \end{equation}

            \item Kroupa (eqn 2 of 2001MNRAS.322..231K):\\
            $$ \xi = M^{-\alpha}
            \begin{cases}
                  \alpha=0.3, & 0.03 \leq M/\msun < 0.08 \\
                  \alpha=1.3, & 0.08 \leq M/\msun < 0.5 \\
                  \alpha=2.3, & 0.5 \leq M/\msun < M_{max}
            \end{cases}
            $$

            \item Chabrier (Eqn 18 of 2003PASP..115..763C):\\
                $$
            \begin{cases}
                \xi(\log M) \equiv \frac{dN}{d\log M} = A \exp\left[-(\log M - \log M_c)^2/2\sigma^2\right]  \\
                A = 0.086, M_c = 0.22, \sigma=0.57 &  M\leq1 \msun\\
                \xi(\log M) = A M^{-\Gamma}   \\
                \Gamma = 1.3, A = 4.43 & M>\msun
            \end{cases}
            $$


        \end{enumerate}

    You will perform calculations using these equations to infer properties of stellar
    populations.

    In AST7939 Spring 2024, 80\% of the credit is for the Salpeter IMF, plus part \ref{sec:plot} for all three distributions.
    The remaining 20\% of the credit is for the other two distributions.

    \begin{enumerate}

        \item For each distribution: Plot these IMFs.
            \label{sec:plot}
            \\
            \\

            Then, for at least the Salpeter distribution, but for full credit, for all 3, compute:
        \item What is the average mass?
        \item What is the average mass of stars with $M>8\msun$?
        \item What is the ratio of the number of high-mass to low-mass stars?
            (use M=8 \msun as the dividing mass)
        \item What is the ratio of the \emph{mass} of high-mass to low-mass stars?
        \item (How) do these numbers change if you change $M_{max}$ to 100 \msun?  To 1000 \msun?
        \item (How) do these numbers change if you change $M_{min}$ from 0.03 \msun to 0.3 \msun?
        \item For a cluster of 1000 stars, how many would you expect to be
            $M>8\msun$ (able to go supernova)?
        \item In an `optimal distribution function' (ODF), the cluster mass to maximum star mass
            is fixed by defining $\int_{M_{max,cl}}^{M_{max}} \xi dM = 1$,
            where $M_{max}$ is the maximum possible mass for a star and $M_{max,cl}$ is
            the most massive star in the cluster.
            From this definition, determine how many stars must be in a cluster
            to form one 10 \msun star or one 100 \msun star.
        \item What \emph{mass} of cluster is required to produce a star of that mass?
        \item In a probability distribution function, there is only a fixed likelihood
            of forming a star of a given mass.  What is the minimum cluster mass
            required to have a $>95\%$ ($>63.21\%$) probability of forming at least one $\geq100$
            \msun star?\\
            Recall that the likelihood of rolling at least one six after 100 rolls
            is equal to one minus the likelihood of rolling \emph{no} sixes in 100 rolls
            i.e., $P(\ge 1 \epsdice{6}) = 1- \left(\frac{5}{6}\right)^{100}$.
        \item Compare the results from the ODF and the PDF for the presence of
            a $M>100\msun$ star.  How can you interpret the difference?
        \item What is the expected light-to-mass ratio of each distribution
            assuming $L = \lsun \left(\frac{M}{\msun}\right)^{3}$?
        \item The IMF is the \emph{system} IMF.  If we are primarily interested
            in the luminosity of a system, splitting the mass between multiple
            stars can make a big difference.  If we assume every star system
            consists of an equal-mass binary, what is the effect on the L/M ratio?
            Is this a reasonable approximation to the multiplicity fraction?
        \item For an ODF, the effective maximum stellar mass can be smaller.
            If all star-forming events in a galaxy occur in Taurus-like
            star-forming regions, with $M_*=100\msun$, what is the maximum
            mass?  What is the resulting L/M ratio?  Recall that this is
            the \emph{maximum} the L/M will be in such a galaxy.
    \end{enumerate}

    You may choose to use external resources, like the \texttt{imf} package,
    but it's a good idea to try to solve some of these - at least the simple
    Salpeter IMF - by hand.

\end{enumerate}


\clearpage
To help make sure you have a clear path forward, I provide the numerical
answers:
\begin{enumerate}
    \item
\begin{enumerate}
    \item
        Salpeter mean mass: 0.11 \\
ChabrierPowerLaw mean mass: 0.67 \\
Kroupa mean mass: 0.43
\item Salpeter Mean M(M$>$8) = 19.40\\
ChabrierPowerLaw Mean M(M$>$8) = 19.87\\
Kroupa Mean M(M$>$8) = 19.87
\item Salpeter N(M$>$8) / N(tot) = 0.00051711, N(M$>$8) / N(low) = 0.00051737\\
ChabrierPowerLaw N(M$>$8) / N(tot) = 0.00839082, N(M$>$8) / N(low) = 0.00846182\\
Kroupa N(M$>$8) / N(tot) = 0.00457265, N(M$>$8) / N(low) = 0.00459366
\item Salpeter M(M$>$8) / M(tot) = 0.0917, M(M$>$8) / M(low) = 0.1010 \\
ChabrierPowerLaw M(M$>$8) / M(tot) = 0.2491, M(M$>$8) / M(low) = 0.3318 \\
Kroupa M(M$>$8) / M(tot) = 0.2094, M(M$>$8) / M(low) = 0.2648
\item Mmax = 100 \\
Salpeter mean mass: 0.11 \\
Salpeter M(M$>$8) / M(tot) = 0.0882, M(M$>$8) / M(low) = 0.0968 \\
Salpeter N(M$>$8) / N(tot) = 0.0001, N(M$>$8) / N(low) = 0.0005 \\
ChabrierPowerLaw mean mass: 0.66 \\
ChabrierPowerLaw M(M$>$8) / M(tot) = 0.2406, M(M$>$8) / M(low) = 0.3169 \\
ChabrierPowerLaw N(M$>$8) / N(tot) = 0.0079, N(M$>$8) / N(low) = 0.0084 \\
Kroupa mean mass: 0.43 \\
Kroupa M(M$>$8) / M(tot) = 0.2019, M(M$>$8) / M(low) = 0.2530 \\
Kroupa N(M$>$8) / N(tot) = 0.0039, N(M$>$8) / N(low) = 0.0046 \\
 \\
Mmax = 1000 \\
Salpeter mean mass: 0.11 \\
Salpeter M(M$>$8) / M(tot) = 0.1185, M(M$>$8) / M(low) = 0.1345 \\
Salpeter N(M$>$8) / N(tot) = 0.0001, N(M$>$8) / N(low) = 0.0005 \\
ChabrierPowerLaw mean mass: 0.73 \\
ChabrierPowerLaw M(M$>$8) / M(tot) = 0.3133, M(M$>$8) / M(low) = 0.4563 \\
ChabrierPowerLaw N(M$>$8) / N(tot) = 0.0081, N(M$>$8) / N(low) = 0.0087 \\
Kroupa mean mass: 0.47 \\
Kroupa M(M$>$8) / M(tot) = 0.2670, M(M$>$8) / M(low) = 0.3643 \\
Kroupa N(M$>$8) / N(tot) = 0.0041, N(M$>$8) / N(low) = 0.0047

\item % (f)
    Mmax = 120, Mmin=0.03 \\
Salpeter mean mass: 0.11 \\
Salpeter M(M$>$8) / M(tot) = 0.0917, M(M$>$8) / M(low) = 0.1010 \\
Salpeter N(M$>$8) / N(tot) = 0.0005, N(M$>$8) / N(low) = 0.0005 \\
ChabrierPowerLaw mean mass: 0.67 \\
ChabrierPowerLaw M(M$>$8) / M(tot) = 0.2491, M(M$>$8) / M(low) = 0.3318 \\
ChabrierPowerLaw N(M$>$8) / N(tot) = 0.0084, N(M$>$8) / N(low) = 0.0085 \\
Kroupa mean mass: 0.43 \\
Kroupa M(M$>$8) / M(tot) = 0.2094, M(M$>$8) / M(low) = 0.2648 \\
Kroupa N(M$>$8) / N(tot) = 0.0046, N(M$>$8) / N(low) = 0.0046 \\
 \\
Mmax = 120, Mmin=0.3 \\
Salpeter mean mass: 1.02 \\
Salpeter M(M$>$8) / M(tot) = 0.2212, M(M$>$8) / M(low) = 0.2841 \\
Salpeter N(M$>$8) / N(tot) = 0.0116, N(M$>$8) / N(low) = 0.0117 \\
ChabrierPowerLaw mean mass: 1.37 \\
ChabrierPowerLaw M(M$>$8) / M(tot) = 0.2817, M(M$>$8) / M(low) = 0.3922 \\
ChabrierPowerLaw N(M$>$8) / N(tot) = 0.0194, N(M$>$8) / N(low) = 0.0198 \\
Kroupa mean mass: 1.18 \\
Kroupa M(M$>$8) / M(tot) = 0.2588, M(M$>$8) / M(low) = 0.3491 \\
Kroupa N(M$>$8) / N(tot) = 0.0046, N(M$>$8) / N(low) = 0.0156

\item % (g)
Salpeter          N(M$>$8) = 0.52  M(N=1000)=1.1e+02\\
ChabrierPowerLaw  N(M$>$8) = 8.39  M(N=1000)=6.7e+02\\
Kroupa            N(M$>$8) = 4.57  M(N=1000)=4.3e+02\\
\\
What about for M=1000? \\
Salpeter          NSN = N(M$>$8) = 4.7\\
ChabrierPowerLaw  NSN = N(M$>$8) = 12.5\\
Kroupa            NSN = N(M$>$8) = 10.5


\item %(h)
Salpeter: nstars to make 10 msun = 2638\\
ChabrierPowerLaw: nstars to make 10 msun = 160\\
Kroupa: nstars to make 10 msun = 295\\
\\
Salpeter: nstars to make 100 msun = 261252\\
ChabrierPowerLaw: nstars to make 100 msun = 14615\\
Kroupa: nstars to make 100 msun = 26818

\item %(i)

Salpeter: mass(100Msun) = 2.9e+04, N(100msun) = 261252 \\
ChabrierPowerLaw: mass(100Msun) = 9.8e+03, N(100msun) = 14615 \\
Kroupa: mass(100Msun) = 1.2e+04, N(100msun) = 26818


\item % (j)

ODF Salpeter P($>$100) = 0.9999961722830673, N* = 1/(1-P($>$100)=261252\\
ODF Salpeter: M = 2.9e+04\\
PDF Salpeter: Min mass for $>$1 100 Msun star at 95\%: 8.6e+04 nstars=782640\\
PDF Salpeter: Min mass for $>$1 100 Msun star at 62.3\%: 2.9e+04 nstars=261237\\
\\
ODF ChabrierPowerLaw P($>$100) = 0.999931578294786, N* = 1/(1-P($>$100)=14615\\
ODF ChabrierPowerLaw: M = 9.8e+03\\
PDF ChabrierPowerLaw: Min mass for $>$1 100 Msun star at 95\%: 2.9e+04 nstars=43781\\
PDF ChabrierPowerLaw: Min mass for $>$1 100 Msun star at 62.3\%: 9.8e+03 nstars=14613\\
\\
ODF Kroupa P($>$100) = 0.9999627129687122, N* = 1/(1-P($>$100)=26818\\
ODF Kroupa: M = 1.2e+04\\
PDF Kroupa: Min mass for $>$1 100 Msun star at 95\%: 3.5e+04 nstars=80340\\
PDF Kroupa: Min mass for $>$1 100 Msun star at 62.3\%: 1.2e+04 nstars=26816\\



\item Answer the question from the above data
\item %(l)
    Salpeter: L/M = 177.3 \\
ChabrierPowerLaw: L/M = 571.2 \\
Kroupa: L/M = 424.5
\item %(m)
    Salpeter: L/M = 44.3 \\
ChabrierPowerLaw: L/M = 142.8 \\
Kroupa: L/M = 106.1
\item %(n)
Salpeter: Mmax = 4.6 L/M = 0.9 \\
ChabrierPowerLaw: Mmax = 9.5 L/M = 8.6 \\
Kroupa: Mmax = 8.3 L/M = 5.7
\end{enumerate}
\end{enumerate}


\end{document}


% 1) Let the students contemplate on what the implications are for star formation and galactic astrophysics if the IMF is either a probability density distribution function or an optimal distribution function.
%
% 2) Calculate the mmax--Mecl relation from the IMF.
%
% 3) Assume the mmax--Mecl relation: calculate the average stellar mass of the embedded cluster with increasing mass of stars in the embedded cluster.
%
% 4) Assume the IMF varies as formulated by Marks et al. (2012 - for an update see https://ui.adsabs.harvard.edu/abs/2021A%26A...655A..19Y/abstract
%
% Calculate the ratio of mass in stars above 1 and 10 Msun relative to the total mass in the stellar population as a function of the metallicity and density of the embedded cluster. Make a two dimensional grid and discuss the results.
%
% 5) Discuss how one can calculate the galaxy-wide IMF and which constraints need to be considered.
